<?xml version="1.0" encoding="utf-8"?>
<Window
  x:Class="MarketCountdownApp.MainWindow"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:local="clr-namespace:MarketCountdownApp"
  Title="Market Countdown"
  WindowStyle="None"
  ResizeMode="NoResize"
  Width="800"
  Height="430"
  Background="Transparent"
  AllowsTransparency="True">

    <!-- ================= -->
    <!--   Window.Resources -->
    <!-- ================= -->
    <Window.Resources>

        <!-- Converter for OPEN/CLOSED ring color -->
        <local:StatusToBrushConverter x:Key="StatusToBrushConverter"/>
        <local:ProgressToArcConverter x:Key="ProgressToArcConverter"/>

        <!-- Style for currency tags -->
        <Style x:Key="CurrencyTagStyle" TargetType="Border">
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="Padding" Value="4,2"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="Background" Value="LightGray"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Currency}" Value="USD">
                    <Setter Property="Background" Value="Crimson"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Currency}" Value="JPY">
                    <Setter Property="Background" Value="DarkGray"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Currency}" Value="CHF">
                    <Setter Property="Background" Value="#F39C12"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Currency}" Value="CAD">
                    <Setter Property="Background" Value="#9B59B6"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Currency}" Value="EUR">
                    <Setter Property="Background" Value="#2ECC71"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Currency}" Value="AUD">
                    <Setter Property="Background" Value="#3498DB"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- (Optional) style stub for local-time text -->
        <Style x:Key="LocalTimeStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Gray"/>
            <!-- You can add DataTriggers here if you want open/closed coloring -->
        </Style>

    </Window.Resources>

    <!-- ================= -->
    <!--   Main Container  -->
    <!-- ================= -->
    <Border Background="#B0B0B0" CornerRadius="15" SnapsToDevicePixels="True">
        <Grid>
            <!-- Two rows: 240px for the market tiles, rest for UP NEXT -->
            <Grid.RowDefinitions>
                <RowDefinition Height="240"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- ==================================== -->
            <!--  2×2 Grid of Market Tiles (Row 0)   -->
            <!-- ==================================== -->
            <UniformGrid Grid.Row="0" Rows="2" Columns="2" Margin="10">

                <!-- London Tile -->
                <Border Background="White" CornerRadius="12" Margin="5">
                    <Grid>
                        <!-- Icon -->
                        <Image Source="pack://siteoforigin:,,,/Icons/London.png"
                   Width="32" Height="32"
                   Margin="10"
                   VerticalAlignment="Top"
                   HorizontalAlignment="Left"/>
                        <!-- Name & Offset -->
                        <StackPanel Margin="60,5,10,5">
                            <TextBlock Text="London" Foreground="#222222" FontSize="14"/>
                            <TextBlock Text="{Binding LondonDisplay}"
                                       FontSize="24"
                                       Foreground="#222222"
                                       HorizontalAlignment="Left"
                                       Margin="60,5,10,5"/>

                        </StackPanel>
                        <!-- Local Time -->
                        <TextBlock Text="{Binding LondonLocalTime}"
                       Style="{StaticResource LocalTimeStyle}"
                       FontSize="12"
                       HorizontalAlignment="Right"
                       VerticalAlignment="Top"
                       Margin="0,6,70,0"/>
                        <!-- OPEN/CLOSED Ring + Text -->
                        <Grid Width="60" Height="60" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,5,10,0">
                            <!-- gray background ring -->
                            <Ellipse Stroke="#DDDDDD" StrokeThickness="6"/>
                            <!-- colored progress arc -->
                            <Path Stroke="{Binding LondonStatus, Converter={StaticResource StatusToBrushConverter}}"
                                  StrokeThickness="6"
                                  Data="{Binding LondonProgress, Converter={StaticResource ProgressToArcConverter}}"/>
                            <!-- status text -->
                            <TextBlock Text="{Binding LondonStatus}"
                                       Foreground="#222222"
                                       FontSize="10"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"/>
                        </Grid>
                        <!-- Glowing status indicator for London -->
                        <Grid Width="20" Height="20"
                              HorizontalAlignment="Left"
                              VerticalAlignment="Top"
                              Margin="8,8,0,0">

                            <!-- Glow layer -->
                            <Ellipse Width="20" Height="20" Opacity="0.3">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <!-- default fill if you want -->
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <!-- OPEN = green glow -->
                                            <DataTrigger Binding="{Binding LondonStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <!-- CLOSED = red glow -->
                                            <DataTrigger Binding="{Binding LondonStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                                <Ellipse.Effect>
                                    <BlurEffect Radius="6"/>
                                </Ellipse.Effect>
                            </Ellipse>

                            <!-- Center dot -->
                            <Ellipse Width="12" Height="12">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding LondonStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding LondonStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                            </Ellipse>

                        </Grid>

                    </Grid>
                </Border>

                <!-- New York Tile -->
                <Border Background="White" CornerRadius="12" Margin="5">
                    <Grid>
                        <Image Source="pack://siteoforigin:,,,/Icons/New_York.png"
                   Width="32" Height="32" Margin="10"
                   VerticalAlignment="Top" HorizontalAlignment="Left"/>
                        <StackPanel Margin="60,5,10,5">
                            <TextBlock Text="New York" Foreground="#222222" FontSize="14"/>
                            <TextBlock Text="{Binding NewYorkDisplay}"
                                       FontSize="24"
                                       Foreground="#222222"
                                       HorizontalAlignment="Left"
                                       Margin="60,5,10,5"/>

                        </StackPanel>
                        <TextBlock Text="{Binding NewYorkLocalTime}"
                       Style="{StaticResource LocalTimeStyle}"
                       FontSize="12"
                       HorizontalAlignment="Right"
                       VerticalAlignment="Top"
                       Margin="0,6,70,0"/>
                        <Grid Width="60" Height="60" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,5,10,0">
                            <!-- gray background ring -->
                            <Ellipse Stroke="#DDDDDD" StrokeThickness="6"/>
                            <!-- colored progress arc -->
                            <Path Stroke="{Binding NewYorkStatus, Converter={StaticResource StatusToBrushConverter}}"
                                  StrokeThickness="6"
                                  Data="{Binding NewYorkProgress, Converter={StaticResource ProgressToArcConverter}}"/>
                            <!-- status text -->
                            <TextBlock Text="{Binding NewYorkStatus}"
                                       Foreground="#222222"
                                       FontSize="10"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"/>
                        </Grid>
                        <!-- Glowing indicator -->
                        <Grid Width="20" Height="20"
                              HorizontalAlignment="Left"
                              VerticalAlignment="Top"
                              Margin="8,8,0,0">

                            <!-- Glow layer -->
                            <Ellipse Width="20" Height="20" Opacity="0.3">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <!-- default fill if you want -->
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <!-- OPEN = green glow -->
                                            <DataTrigger Binding="{Binding NewYorkStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <!-- CLOSED = red glow -->
                                            <DataTrigger Binding="{Binding NewYorkStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                                <Ellipse.Effect>
                                    <BlurEffect Radius="6"/>
                                </Ellipse.Effect>
                            </Ellipse>

                            <!-- Center dot -->
                            <Ellipse Width="12" Height="12">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding NewYorStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding NewYorkStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                            </Ellipse>

                        </Grid>
                    </Grid>
                </Border>

                <!-- Sydney Tile -->
                <Border Background="White" CornerRadius="12" Margin="5">
                    <Grid>
                        <Image Source="pack://siteoforigin:,,,/Icons/Sydney.png"
                   Width="32" Height="32" Margin="10"
                   VerticalAlignment="Top" HorizontalAlignment="Left"/>
                        <StackPanel Margin="60,5,10,5">
                            <TextBlock Text="Sydney" Foreground="#222222" FontSize="14"/>
                            <TextBlock Text="{Binding SydneyDisplay}"
                                       FontSize="24"
                                       Foreground="#222222"
                                       HorizontalAlignment="Left"
                                       Margin="60,5,10,5"/>

                        </StackPanel>
                        <TextBlock Text="{Binding SydneyLocalTime}"
                       Style="{StaticResource LocalTimeStyle}"
                       FontSize="12"
                       HorizontalAlignment="Right"
                       VerticalAlignment="Top"
                       Margin="0,6,70,0"/>
                        <Grid Width="60" Height="60" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,5,10,0">
                            <!-- gray background ring -->
                            <Ellipse Stroke="#DDDDDD" StrokeThickness="6"/>
                            <!-- colored progress arc -->
                            <Path Stroke="{Binding SydneyStatus, Converter={StaticResource StatusToBrushConverter}}"
                                  StrokeThickness="6"
                                  Data="{Binding SydneyProgress, Converter={StaticResource ProgressToArcConverter}}"/>
                            <!-- status text -->
                            <TextBlock Text="{Binding SydneyStatus}"
                                       Foreground="#222222"
                                       FontSize="10"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"/>
                        </Grid>
                        <!-- Glowing indicator -->
                        <Grid Width="20" Height="20"
                              HorizontalAlignment="Left"
                              VerticalAlignment="Top"
                              Margin="8,8,0,0">

                            <!-- Glow layer -->
                            <Ellipse Width="20" Height="20" Opacity="0.3">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <!-- default fill if you want -->
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <!-- OPEN = green glow -->
                                            <DataTrigger Binding="{Binding SydneyStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <!-- CLOSED = red glow -->
                                            <DataTrigger Binding="{Binding SydneyStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                                <Ellipse.Effect>
                                    <BlurEffect Radius="6"/>
                                </Ellipse.Effect>
                            </Ellipse>

                            <!-- Center dot -->
                            <Ellipse Width="12" Height="12">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SydneyStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding SydneyStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                            </Ellipse>

                        </Grid>
                    </Grid>
                </Border>

                <!-- Tokyo Tile -->
                <Border Background="White" CornerRadius="12" Margin="5">
                    <Grid>
                        <Image Source="pack://siteoforigin:,,,/Icons/Tokyo.png"
                   Width="32" Height="32" Margin="10"
                   VerticalAlignment="Top" HorizontalAlignment="Left"/>
                        <StackPanel Margin="60,5,10,5">
                            <TextBlock Text="Tokyo" Foreground="#222222" FontSize="14"/>
                            <TextBlock Text="{Binding TokyoDisplay}"
                                       FontSize="24"
                                       Foreground="#222222"
                                       HorizontalAlignment="Left"
                                       Margin="60,5,10,5"/>

                        </StackPanel>
                        <TextBlock Text="{Binding TokyoLocalTime}"
                       Style="{StaticResource LocalTimeStyle}"
                       FontSize="12"
                       HorizontalAlignment="Right"
                       VerticalAlignment="Top"
                       Margin="0,6,70,0"/>
                        <Grid Width="60" Height="60" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,5,10,0">
                            <!-- gray background ring -->
                            <Ellipse Stroke="#DDDDDD" StrokeThickness="6"/>
                            <!-- colored progress arc -->
                            <Path Stroke="{Binding TokyoStatus, Converter={StaticResource StatusToBrushConverter}}"
                                  StrokeThickness="6"
                                  Data="{Binding TokyoProgress, Converter={StaticResource ProgressToArcConverter}}"/>
                            <!-- status text -->
                            <TextBlock Text="{Binding TokyoStatus}"
                                       Foreground="#222222"
                                       FontSize="10"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"/>
                        </Grid>
                        <!-- Glowing indicator -->
                        <Grid Width="20" Height="20"
                              HorizontalAlignment="Left"
                              VerticalAlignment="Top"
                              Margin="8,8,0,0">

                            <!-- Glow layer -->
                            <Ellipse Width="20" Height="20" Opacity="0.3">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <!-- default fill if you want -->
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <!-- OPEN = green glow -->
                                            <DataTrigger Binding="{Binding TokyoStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <!-- CLOSED = red glow -->
                                            <DataTrigger Binding="{Binding TokyoStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                                <Ellipse.Effect>
                                    <BlurEffect Radius="6"/>
                                </Ellipse.Effect>
                            </Ellipse>

                            <!-- Center dot -->
                            <Ellipse Width="12" Height="12">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding TokyoStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding TokyoStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                            </Ellipse>

                        </Grid>
                    </Grid>
                </Border>

            </UniformGrid>

            <!-- =================================== -->
            <!--  “UP NEXT” Section (Row 1)          -->
            <!-- =================================== -->
            <Border Grid.Row="1" Background="White" CornerRadius="12" Margin="10">
                <StackPanel>

                    <!-- Centered “UP NEXT” Header -->
                    <Grid Margin="10,5">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <Rectangle Grid.Column="0" Height="1" Fill="#222222" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBlock Grid.Column="1" Text="UP NEXT" Foreground="#222222"
                       FontSize="16" FontWeight="Bold" VerticalAlignment="Center"/>
                        <Rectangle Grid.Column="2" Height="1" Fill="#222222" VerticalAlignment="Center" Margin="5,0,0,0"/>
                    </Grid>

                    <!-- Event List with Currency Tags -->
                    <ListView ItemsSource="{Binding UpcomingEvents}" Margin="10">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Margin="0,2">
                                    <TextBlock Text="{Binding Time}" Foreground="#222222" Width="80"/>
                                    <Border Style="{StaticResource CurrencyTagStyle}">
                                        <TextBlock Text="{Binding Currency}" Foreground="White" FontSize="12"/>
                                    </Border>
                                    <TextBlock Text="{Binding Description}" Foreground="#222222" Margin="5,0,0,0"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>

                </StackPanel>
            </Border>

            <!-- Settings Gear in Top Panel -->
            <Image
        Grid.Row="0"
        Source="pack://siteoforigin:,,,/Icons/Settings.png"
        Width="18"
        Height="18"
        HorizontalAlignment="Right"
        VerticalAlignment="Bottom"
        Margin="0,0,12,-7"/>
        </Grid>
    </Border>
</Window>
