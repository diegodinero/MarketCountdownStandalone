<?xml version="1.0" encoding="utf-8"?>
<Window
  x:Class="MarketCountdownApp.MainWindow"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:local="clr-namespace:MarketCountdownApp"
  Title="Market Countdown"
  WindowStyle="None"
  ResizeMode="NoResize"
  Width="600"
  Height="530"
  Background="Transparent"
  AllowsTransparency="True">

    <!-- ================= -->
    <!--  Window.Resources  -->
    <!-- ================= -->
    <Window.Resources>
        <local:StatusToBrushConverter x:Key="StatusToBrushConverter"/>
        <local:ProgressToArcConverter  x:Key="ProgressToArcConverter"/>

        <Style x:Key="CurrencyTagStyle" TargetType="Border">
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="Padding"     Value="4,2"/>
            <Setter Property="Margin"      Value="6,0"/>
            <Setter Property="Background"  Value="LightGray"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Currency}" Value="USD">
                    <Setter Property="Background" Value="Crimson"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Currency}" Value="JPY">
                    <Setter Property="Background" Value="DarkGray"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Currency}" Value="CHF">
                    <Setter Property="Background" Value="#F39C12"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Currency}" Value="CAD">
                    <Setter Property="Background" Value="#9B59B6"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Currency}" Value="EUR">
                    <Setter Property="Background" Value="#2ECC71"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Currency}" Value="AUD">
                    <Setter Property="Background" Value="#3498DB"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="LocalTimeStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Gray"/>
            <Setter Property="FontSize"   Value="11"/>
        </Style>
    </Window.Resources>

    <!-- ================= -->
    <!--   Main Container  -->
    <!-- ================= -->
    <Border Background="#B0B0B0" CornerRadius="15" SnapsToDevicePixels="True">
        <Grid>
            <!-- three rows: 0=tiles, 1=list, 2=footer/date -->
            <Grid.RowDefinitions>
                <RowDefinition Height="240"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- ==================================== -->
            <!--  2×2 Grid of Market Tiles (Row 0)    -->
            <!-- ==================================== -->
            <UniformGrid Grid.Row="0" Rows="2" Columns="2" Margin="8">

                <!-- London Tile -->
                <Border Background="White" CornerRadius="12" Margin="4">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="60"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="60"/>
                        </Grid.ColumnDefinitions>
                        <Image Grid.Column="0"
                   Source="pack://siteoforigin:,,,/Icons/London.png"
                   Width="48" Height="48"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"/>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="London"      FontSize="14" Foreground="#222222"/>
                            <TextBlock Text="{Binding LondonDisplay}" FontSize="24" Foreground="#222222"/>
                        </StackPanel>
                        <TextBlock Grid.Column="2"
                       Text="{Binding LondonLocalTime}"
                       Style="{StaticResource LocalTimeStyle}"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Top"/>
                        <Grid Grid.Column="3"
                  Width="60" Height="60"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                            <Ellipse Stroke="#DDDDDD" StrokeThickness="6"/>
                            <Path   Stroke="{Binding LondonStatus, Converter={StaticResource StatusToBrushConverter}}"
                      StrokeThickness="6"
                      Data="{Binding LondonProgress, Converter={StaticResource ProgressToArcConverter}}"/>
                            <TextBlock Text="{Binding LondonStatus}"
                         FontSize="10"
                         FontWeight="Bold"
                         Foreground="#222222"
                         HorizontalAlignment="Center"
                         VerticalAlignment="Center"/>
                        </Grid>
                        <!-- glowing dot -->
                        <Grid Grid.Column="0"
                  Width="20" Height="20"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  Margin="6">
                            <Ellipse Width="20" Height="20" Opacity="0.3">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding LondonStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding LondonStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                                <Ellipse.Effect>
                                    <BlurEffect Radius="6"/>
                                </Ellipse.Effect>
                            </Ellipse>
                            <Ellipse Width="12" Height="12"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding LondonStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding LondonStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                            </Ellipse>
                        </Grid>
                    </Grid>
                </Border>

                <!-- Repeat the same structure for New York, Sydney, Tokyo -->
                <!-- … New York … -->
                <Border Background="White" CornerRadius="12" Margin="4">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="60"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="60"/>
                        </Grid.ColumnDefinitions>
                        <Image Grid.Column="0"
                   Source="pack://siteoforigin:,,,/Icons/New_York.png"
                   Width="48" Height="48"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"/>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="New York" FontSize="14" Foreground="#222222"/>
                            <TextBlock Text="{Binding NewYorkDisplay}" FontSize="24" Foreground="#222222"/>
                        </StackPanel>
                        <TextBlock Grid.Column="2"
                       Text="{Binding NewYorkLocalTime}"
                       Style="{StaticResource LocalTimeStyle}"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Top"/>
                        <Grid Grid.Column="3"
                  Width="60" Height="60"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                            <Ellipse Stroke="#DDDDDD" StrokeThickness="6"/>
                            <Path   Stroke="{Binding NewYorkStatus, Converter={StaticResource StatusToBrushConverter}}"
                      StrokeThickness="6"
                      Data="{Binding NewYorkProgress, Converter={StaticResource ProgressToArcConverter}}"/>
                            <TextBlock Text="{Binding NewYorkStatus}"
                         FontSize="10"
                         FontWeight="Bold"
                         Foreground="#222222"
                         HorizontalAlignment="Center"
                         VerticalAlignment="Center"/>
                        </Grid>
                        <Grid Grid.Column="0"
                  Width="20" Height="20"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  Margin="6">
                            <Ellipse Width="20" Height="20" Opacity="0.3">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding NewYorkStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding NewYorkStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                                <Ellipse.Effect>
                                    <BlurEffect Radius="6"/>
                                </Ellipse.Effect>
                            </Ellipse>
                            <Ellipse Width="12" Height="12"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding NewYorkStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding NewYorkStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                            </Ellipse>
                        </Grid>
                    </Grid>
                </Border>

                <!-- Sydney -->
                <Border Background="White" CornerRadius="12" Margin="4">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="60"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="60"/>
                        </Grid.ColumnDefinitions>
                        <Image Grid.Column="0"
                   Source="pack://siteoforigin:,,,/Icons/Sydney.png"
                   Width="48" Height="48"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"/>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="Sydney" FontSize="14" Foreground="#222222"/>
                            <TextBlock Text="{Binding SydneyDisplay}" FontSize="24" Foreground="#222222"/>
                        </StackPanel>
                        <TextBlock Grid.Column="2"
                       Text="{Binding SydneyLocalTime}"
                       Style="{StaticResource LocalTimeStyle}"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Top"/>
                        <Grid Grid.Column="3"
                  Width="60" Height="60"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                            <Ellipse Stroke="#DDDDDD" StrokeThickness="6"/>
                            <Path   Stroke="{Binding SydneyStatus, Converter={StaticResource StatusToBrushConverter}}"
                      StrokeThickness="6"
                      Data="{Binding SydneyProgress, Converter={StaticResource ProgressToArcConverter}}"/>
                            <TextBlock Text="{Binding SydneyStatus}"
                         FontSize="10"
                         FontWeight="Bold"
                         Foreground="#222222"
                         HorizontalAlignment="Center"
                         VerticalAlignment="Center"/>
                        </Grid>
                        <Grid Grid.Column="0"
                  Width="20" Height="20"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  Margin="6">
                            <Ellipse Width="20" Height="20" Opacity="0.3">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SydneyStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding SydneyStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                                <Ellipse.Effect>
                                    <BlurEffect Radius="6"/>
                                </Ellipse.Effect>
                            </Ellipse>
                            <Ellipse Width="12" Height="12"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SydneyStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding SydneyStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                            </Ellipse>
                        </Grid>
                    </Grid>
                </Border>

                <!-- Tokyo -->
                <Border Background="White" CornerRadius="12" Margin="4">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="60"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="60"/>
                        </Grid.ColumnDefinitions>
                        <Image Grid.Column="0"
                   Source="pack://siteoforigin:,,,/Icons/Tokyo.png"
                   Width="48" Height="48"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"/>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="Tokyo" FontSize="14" Foreground="#222222"/>
                            <TextBlock Text="{Binding TokyoDisplay}" FontSize="24" Foreground="#222222"/>
                        </StackPanel>
                        <TextBlock Grid.Column="2"
                       Text="{Binding TokyoLocalTime}"
                       Style="{StaticResource LocalTimeStyle}"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Top"/>
                        <Grid Grid.Column="3"
                  Width="60" Height="60"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                            <Ellipse Stroke="#DDDDDD" StrokeThickness="6"/>
                            <Path   Stroke="{Binding TokyoStatus, Converter={StaticResource StatusToBrushConverter}}"
                      StrokeThickness="6"
                      Data="{Binding TokyoProgress, Converter={StaticResource ProgressToArcConverter}}"/>
                            <TextBlock Text="{Binding TokyoStatus}"
                         FontSize="10"
                         FontWeight="Bold"
                         Foreground="#222222"
                         HorizontalAlignment="Center"
                         VerticalAlignment="Center"/>
                        </Grid>
                        <Grid Grid.Column="0"
                  Width="20" Height="20"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  Margin="6">
                            <Ellipse Width="20" Height="20" Opacity="0.3">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding TokyoStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding TokyoStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                                <Ellipse.Effect>
                                    <BlurEffect Radius="6"/>
                                </Ellipse.Effect>
                            </Ellipse>
                            <Ellipse Width="12" Height="12"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Setter Property="Fill" Value="Gray"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding TokyoStatus}" Value="OPEN">
                                                <Setter Property="Fill" Value="#40C832"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding TokyoStatus}" Value="CLOSED">
                                                <Setter Property="Fill" Value="#EB5757"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                            </Ellipse>
                        </Grid>
                    </Grid>
                </Border>
            </UniformGrid>

            <!-- =================================== -->
            <!--  “UP NEXT” Section (Row 1)          -->
            <!-- =================================== -->
            <Border Grid.Row="1"
              Background="White"
              CornerRadius="12"
              Margin="8"
              Padding="0">
                <Grid Margin="12">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- header -->
                    <Grid Grid.Row="0" Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <Rectangle Grid.Column="0" Height="1" Fill="#222222" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBlock Grid.Column="1"
                       Text="UP NEXT"
                       FontSize="16"
                       FontWeight="Bold"
                       Foreground="#222222"
                       VerticalAlignment="Center"/>
                        <Rectangle Grid.Column="2" Height="1" Fill="#222222" VerticalAlignment="Center" Margin="5,0,0,0"/>
                    </Grid>

                    <!-- scrollable list -->
                    <ListView Grid.Row="1"
                    ItemsSource="{Binding UpcomingEvents}"
                    ScrollViewer.VerticalScrollBarVisibility="Auto">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Margin="0,4">
                                    <TextBlock Text="{Binding Time}"
                             FontSize="13"
                             Foreground="#222222"
                             Width="70"/>
                                    <Border Style="{StaticResource CurrencyTagStyle}"
                          VerticalAlignment="Center">
                                        <TextBlock Text="{Binding Currency}"
                               FontSize="12"
                               FontWeight="Bold"
                               Foreground="White"/>
                                    </Border>
                                    <TextBlock Text="{Binding Description}"
                             FontSize="13"
                             Foreground="#222222"
                             Margin="8,0,0,0"
                             VerticalAlignment="Center"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>
            </Border>

            <!-- settings gear in bottom-right of tile area -->
            <Image Grid.Row="0"
             Source="pack://siteoforigin:,,,/Icons/Settings.png"
             Width="18"
             Height="18"
             HorizontalAlignment="Right"
             VerticalAlignment="Bottom"
             Margin="0,0,12,12"/>

            <!-- date pill on grey background (Row 2) -->
            <Border Grid.Row="2"
              Background="White"
              CornerRadius="8"
              HorizontalAlignment="Left"
              VerticalAlignment="Center"
              Margin="12"
              Padding="6,2">
                <TextBlock Text="{Binding TodayDate}"
                   FontSize="12"
                   Foreground="#222222"/>
                <Border.Effect>
                    <DropShadowEffect Color="#000000"
                            BlurRadius="4"
                            Opacity="0.2"
                            Direction="270"
                            ShadowDepth="1"/>
                </Border.Effect>
            </Border>
        </Grid>
    </Border>
</Window>
